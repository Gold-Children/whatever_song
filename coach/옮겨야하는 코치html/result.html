{% extends "base.html" %}
{% load static %}
{% block content %}
    
    <h1>Result</h1>
    <div>
        <p>High Pitch Score: <span id="high_pitch_score"></span></p>
        <p>Low Pitch Score: <span id="low_pitch_score"></span></p>
        <p>Pitch Score: <span id="pitch_score"></span></p>
        <p>Message: <span id="message"></span></p>
        <img id="graph" src = "" alt="Graph">
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const pk = window.location.pathname.split('/').slice(-2, -1)[0];
            function loadResult() {
                const token = localStorage.getItem('access');
                if (!token) {
                    console.error('No access token found');
                    return;
                }
                axios.get(`api/coach/api/result/${pk}/`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                })
                .then(response => {
                    const data = response.data;
                    document.getElementById('high_pitch_score').innerText = data.high_pitch_score;
                    document.getElementById('low_pitch_score').innerText = data.low_pitch_score;
                    document.getElementById('pitch_score').innerText = data.pitch_score;
                    document.getElementById('message').innerText = data.message;
                    if (data.graph) {
                        document.getElementById('graph').src = data.graph;
                    }
                })
                .catch(error => console.error('Error:', error));
            }
            loadResult();
        });
    </script>
{% endblock content %}
